<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>class Concurrent::TimerTask - concurrent-ruby-1.0.2 Documentation</title>

<link type="text/css" media="screen" href="../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../index.html">Home</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  

  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/concurrent/timer_task.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link"><a href="RubyExecutorService.html">Concurrent::RubyExecutorService</a>
  
</nav>

    <!-- Included Modules -->
<nav id="includes-section" class="section">
  <h3 class="section-header">Included Modules</h3>

  <ul class="link-list">
  
  
    <li><a class="include" href="Concern/Dereferenceable.html">Concurrent::Concern::Dereferenceable</a>
  
  
  
    <li><a class="include" href="Concern/Observable.html">Concurrent::Concern::Observable</a>
  
  
  </ul>
</nav>

    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li ><a href="#method-c-execute">::execute</a>
    
    <li class="calls-super" ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-execute">#execute</a>
    
    <li ><a href="#method-i-execute_task">#execute_task</a>
    
    <li ><a href="#method-i-execution_interval">#execution_interval</a>
    
    <li ><a href="#method-i-execution_interval-3D">#execution_interval=</a>
    
    <li ><a href="#method-i-ns_initialize">#ns_initialize</a>
    
    <li class="calls-super" ><a href="#method-i-ns_kill_execution">#ns_kill_execution</a>
    
    <li class="calls-super" ><a href="#method-i-ns_shutdown_execution">#ns_shutdown_execution</a>
    
    <li ><a href="#method-i-running-3F">#running?</a>
    
    <li ><a href="#method-i-schedule_next_task">#schedule_next_task</a>
    
    <li ><a href="#method-i-timeout_interval">#timeout_interval</a>
    
    <li ><a href="#method-i-timeout_interval-3D">#timeout_interval=</a>
    
    <li ><a href="#method-i-timeout_task">#timeout_task</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="../CHANGELOG_md.html">CHANGELOG</a>
  
    <li class="file"><a href="../LICENSE_txt.html">LICENSE</a>
  
    <li class="file"><a href="../README_md.html">README</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../Concurrent.html">Concurrent</a>
  
    <li><a href="../Concurrent/AbstractExchanger.html">Concurrent::AbstractExchanger</a>
  
    <li><a href="../Concurrent/AbstractExecutorService.html">Concurrent::AbstractExecutorService</a>
  
    <li><a href="../Concurrent/AbstractThreadLocalVar.html">Concurrent::AbstractThreadLocalVar</a>
  
    <li><a href="../Concurrent/Agent.html">Concurrent::Agent</a>
  
    <li><a href="../Concurrent/Agent/Error.html">Concurrent::Agent::Error</a>
  
    <li><a href="../Concurrent/Agent/ValidationError.html">Concurrent::Agent::ValidationError</a>
  
    <li><a href="../Concurrent/Array.html">Concurrent::Array</a>
  
    <li><a href="../Concurrent/Async.html">Concurrent::Async</a>
  
    <li><a href="../Concurrent/Async/AsyncDelegator.html">Concurrent::Async::AsyncDelegator</a>
  
    <li><a href="../Concurrent/Async/AwaitDelegator.html">Concurrent::Async::AwaitDelegator</a>
  
    <li><a href="../Concurrent/Async/ClassMethods.html">Concurrent::Async::ClassMethods</a>
  
    <li><a href="../Concurrent/AtExitImplementation.html">Concurrent::AtExitImplementation</a>
  
    <li><a href="../Concurrent/Atom.html">Concurrent::Atom</a>
  
    <li><a href="../Concurrent/AtomicBoolean.html">Concurrent::AtomicBoolean</a>
  
    <li><a href="../Concurrent/AtomicDirectUpdate.html">Concurrent::AtomicDirectUpdate</a>
  
    <li><a href="../Concurrent/AtomicFixnum.html">Concurrent::AtomicFixnum</a>
  
    <li><a href="../Concurrent/AtomicNumericCompareAndSetWrapper.html">Concurrent::AtomicNumericCompareAndSetWrapper</a>
  
    <li><a href="../Concurrent/AtomicReference.html">Concurrent::AtomicReference</a>
  
    <li><a href="../Concurrent/CAtomicReference.html">Concurrent::CAtomicReference</a>
  
    <li><a href="../Concurrent/CachedThreadPool.html">Concurrent::CachedThreadPool</a>
  
    <li><a href="../Concurrent/Collection.html">Concurrent::Collection</a>
  
    <li><a href="../Concurrent/Collection/AtomicReferenceMapBackend.html">Concurrent::Collection::AtomicReferenceMapBackend</a>
  
    <li><a href="../Concurrent/Collection/AtomicReferenceMapBackend/Node.html">Concurrent::Collection::AtomicReferenceMapBackend::Node</a>
  
    <li><a href="../Concurrent/Collection/AtomicReferenceMapBackend/Table.html">Concurrent::Collection::AtomicReferenceMapBackend::Table</a>
  
    <li><a href="../Concurrent/Collection/CopyOnNotifyObserverSet.html">Concurrent::Collection::CopyOnNotifyObserverSet</a>
  
    <li><a href="../Concurrent/Collection/CopyOnWriteObserverSet.html">Concurrent::Collection::CopyOnWriteObserverSet</a>
  
    <li><a href="../Concurrent/Collection/JavaNonConcurrentPriorityQueue.html">Concurrent::Collection::JavaNonConcurrentPriorityQueue</a>
  
    <li><a href="../Concurrent/Collection/MriMapBackend.html">Concurrent::Collection::MriMapBackend</a>
  
    <li><a href="../Concurrent/Collection/NonConcurrentMapBackend.html">Concurrent::Collection::NonConcurrentMapBackend</a>
  
    <li><a href="../Concurrent/Collection/NonConcurrentPriorityQueue.html">Concurrent::Collection::NonConcurrentPriorityQueue</a>
  
    <li><a href="../Concurrent/Collection/RubyNonConcurrentPriorityQueue.html">Concurrent::Collection::RubyNonConcurrentPriorityQueue</a>
  
    <li><a href="../Concurrent/Collection/SynchronizedMapBackend.html">Concurrent::Collection::SynchronizedMapBackend</a>
  
    <li><a href="../Concurrent/Concern.html">Concurrent::Concern</a>
  
    <li><a href="../Concurrent/Concern/Deprecation.html">Concurrent::Concern::Deprecation</a>
  
    <li><a href="../Concurrent/Concern/Dereferenceable.html">Concurrent::Concern::Dereferenceable</a>
  
    <li><a href="../Concurrent/Concern/Logging.html">Concurrent::Concern::Logging</a>
  
    <li><a href="../Concurrent/Concern/Obligation.html">Concurrent::Concern::Obligation</a>
  
    <li><a href="../Concurrent/Concern/Observable.html">Concurrent::Concern::Observable</a>
  
    <li><a href="../Concurrent/ConcurrentUpdateError.html">Concurrent::ConcurrentUpdateError</a>
  
    <li><a href="../Concurrent/CountDownLatch.html">Concurrent::CountDownLatch</a>
  
    <li><a href="../Concurrent/CyclicBarrier.html">Concurrent::CyclicBarrier</a>
  
    <li><a href="../Concurrent/Delay.html">Concurrent::Delay</a>
  
    <li><a href="../Concurrent/DependencyCounter.html">Concurrent::DependencyCounter</a>
  
    <li><a href="../Concurrent/Edge.html">Concurrent::Edge</a>
  
    <li><a href="../Concurrent/Event.html">Concurrent::Event</a>
  
    <li><a href="../Concurrent/Exchanger.html">Concurrent::Exchanger</a>
  
    <li><a href="../Concurrent/ExecutorService.html">Concurrent::ExecutorService</a>
  
    <li><a href="../Concurrent/FixedThreadPool.html">Concurrent::FixedThreadPool</a>
  
    <li><a href="../Concurrent/Future.html">Concurrent::Future</a>
  
    <li><a href="../Concurrent/Hash.html">Concurrent::Hash</a>
  
    <li><a href="../Concurrent/IVar.html">Concurrent::IVar</a>
  
    <li><a href="../Concurrent/ImmediateExecutor.html">Concurrent::ImmediateExecutor</a>
  
    <li><a href="../Concurrent/ImmutableStruct.html">Concurrent::ImmutableStruct</a>
  
    <li><a href="../Concurrent/IndirectImmediateExecutor.html">Concurrent::IndirectImmediateExecutor</a>
  
    <li><a href="../Concurrent/JavaAtomicReference.html">Concurrent::JavaAtomicReference</a>
  
    <li><a href="../Concurrent/JavaCountDownLatch.html">Concurrent::JavaCountDownLatch</a>
  
    <li><a href="../Concurrent/JavaExchanger.html">Concurrent::JavaExchanger</a>
  
    <li><a href="../Concurrent/JavaExecutorService.html">Concurrent::JavaExecutorService</a>
  
    <li><a href="../Concurrent/JavaExecutorService/Job.html">Concurrent::JavaExecutorService::Job</a>
  
    <li><a href="../Concurrent/JavaSingleThreadExecutor.html">Concurrent::JavaSingleThreadExecutor</a>
  
    <li><a href="../Concurrent/JavaThreadLocalVar.html">Concurrent::JavaThreadLocalVar</a>
  
    <li><a href="../Concurrent/JavaThreadPoolExecutor.html">Concurrent::JavaThreadPoolExecutor</a>
  
    <li><a href="../Concurrent/LazyRegister.html">Concurrent::LazyRegister</a>
  
    <li><a href="../Concurrent/MVar.html">Concurrent::MVar</a>
  
    <li><a href="../Concurrent/Map.html">Concurrent::Map</a>
  
    <li><a href="../Concurrent/Maybe.html">Concurrent::Maybe</a>
  
    <li><a href="../Concurrent/MutableStruct.html">Concurrent::MutableStruct</a>
  
    <li><a href="../Concurrent/MutexAtomicBoolean.html">Concurrent::MutexAtomicBoolean</a>
  
    <li><a href="../Concurrent/MutexAtomicFixnum.html">Concurrent::MutexAtomicFixnum</a>
  
    <li><a href="../Concurrent/MutexAtomicReference.html">Concurrent::MutexAtomicReference</a>
  
    <li><a href="../Concurrent/MutexCountDownLatch.html">Concurrent::MutexCountDownLatch</a>
  
    <li><a href="../Concurrent/MutexSemaphore.html">Concurrent::MutexSemaphore</a>
  
    <li><a href="../Concurrent/Options.html">Concurrent::Options</a>
  
    <li><a href="../Concurrent/Process.html">Concurrent::Process</a>
  
    <li><a href="../Concurrent/Promise.html">Concurrent::Promise</a>
  
    <li><a href="../Concurrent/RbxAtomicReference.html">Concurrent::RbxAtomicReference</a>
  
    <li><a href="../Concurrent/ReadWriteLock.html">Concurrent::ReadWriteLock</a>
  
    <li><a href="../Concurrent/ReentrantReadWriteLock.html">Concurrent::ReentrantReadWriteLock</a>
  
    <li><a href="../Concurrent/RubyExchanger.html">Concurrent::RubyExchanger</a>
  
    <li><a href="../Concurrent/RubyExchanger/Node.html">Concurrent::RubyExchanger::Node</a>
  
    <li><a href="../Concurrent/RubyExecutorService.html">Concurrent::RubyExecutorService</a>
  
    <li><a href="../Concurrent/RubySingleThreadExecutor.html">Concurrent::RubySingleThreadExecutor</a>
  
    <li><a href="../Concurrent/RubyThreadLocalVar.html">Concurrent::RubyThreadLocalVar</a>
  
    <li><a href="../Concurrent/RubyThreadPoolExecutor.html">Concurrent::RubyThreadPoolExecutor</a>
  
    <li><a href="../Concurrent/RubyThreadPoolExecutor/Worker.html">Concurrent::RubyThreadPoolExecutor::Worker</a>
  
    <li><a href="../Concurrent/SafeTaskExecutor.html">Concurrent::SafeTaskExecutor</a>
  
    <li><a href="../Concurrent/ScheduledTask.html">Concurrent::ScheduledTask</a>
  
    <li><a href="../Concurrent/Semaphore.html">Concurrent::Semaphore</a>
  
    <li><a href="../Concurrent/SerialExecutorService.html">Concurrent::SerialExecutorService</a>
  
    <li><a href="../Concurrent/SerializedExecution.html">Concurrent::SerializedExecution</a>
  
    <li><a href="../Concurrent/SerializedExecutionDelegator.html">Concurrent::SerializedExecutionDelegator</a>
  
    <li><a href="../Concurrent/SettableStruct.html">Concurrent::SettableStruct</a>
  
    <li><a href="../Concurrent/SimpleExecutorService.html">Concurrent::SimpleExecutorService</a>
  
    <li><a href="../Concurrent/SingleThreadExecutor.html">Concurrent::SingleThreadExecutor</a>
  
    <li><a href="../Concurrent/Synchronization.html">Concurrent::Synchronization</a>
  
    <li><a href="../Concurrent/Synchronization/AbstractLockableObject.html">Concurrent::Synchronization::AbstractLockableObject</a>
  
    <li><a href="../Concurrent/Synchronization/AbstractObject.html">Concurrent::Synchronization::AbstractObject</a>
  
    <li><a href="../Concurrent/Synchronization/AbstractStruct.html">Concurrent::Synchronization::AbstractStruct</a>
  
    <li><a href="../Concurrent/Synchronization/Condition.html">Concurrent::Synchronization::Condition</a>
  
    <li><a href="../Concurrent/Synchronization/JRubyAttrVolatile.html">Concurrent::Synchronization::JRubyAttrVolatile</a>
  
    <li><a href="../Concurrent/Synchronization/JRubyAttrVolatile/ClassMethods.html">Concurrent::Synchronization::JRubyAttrVolatile::ClassMethods</a>
  
    <li><a href="../Concurrent/Synchronization/JRubyLockableObject.html">Concurrent::Synchronization::JRubyLockableObject</a>
  
    <li><a href="../Concurrent/Synchronization/JRubyObject.html">Concurrent::Synchronization::JRubyObject</a>
  
    <li><a href="../Concurrent/Synchronization/Lock.html">Concurrent::Synchronization::Lock</a>
  
    <li><a href="../Concurrent/Synchronization/LockableObject.html">Concurrent::Synchronization::LockableObject</a>
  
    <li><a href="../Concurrent/Synchronization/MriAttrVolatile.html">Concurrent::Synchronization::MriAttrVolatile</a>
  
    <li><a href="../Concurrent/Synchronization/MriAttrVolatile/ClassMethods.html">Concurrent::Synchronization::MriAttrVolatile::ClassMethods</a>
  
    <li><a href="../Concurrent/Synchronization/MriLockableObject.html">Concurrent::Synchronization::MriLockableObject</a>
  
    <li><a href="../Concurrent/Synchronization/MriMonitorLockableObject.html">Concurrent::Synchronization::MriMonitorLockableObject</a>
  
    <li><a href="../Concurrent/Synchronization/MriMutexLockableObject.html">Concurrent::Synchronization::MriMutexLockableObject</a>
  
    <li><a href="../Concurrent/Synchronization/MriObject.html">Concurrent::Synchronization::MriObject</a>
  
    <li><a href="../Concurrent/Synchronization/Object.html">Concurrent::Synchronization::Object</a>
  
    <li><a href="../Concurrent/Synchronization/RbxAttrVolatile.html">Concurrent::Synchronization::RbxAttrVolatile</a>
  
    <li><a href="../Concurrent/Synchronization/RbxAttrVolatile/ClassMethods.html">Concurrent::Synchronization::RbxAttrVolatile::ClassMethods</a>
  
    <li><a href="../Concurrent/Synchronization/RbxLockableObject.html">Concurrent::Synchronization::RbxLockableObject</a>
  
    <li><a href="../Concurrent/Synchronization/RbxObject.html">Concurrent::Synchronization::RbxObject</a>
  
    <li><a href="../Concurrent/Synchronization/TruffleAttrVolatile.html">Concurrent::Synchronization::TruffleAttrVolatile</a>
  
    <li><a href="../Concurrent/Synchronization/TruffleAttrVolatile/ClassMethods.html">Concurrent::Synchronization::TruffleAttrVolatile::ClassMethods</a>
  
    <li><a href="../Concurrent/Synchronization/TruffleLockableObject.html">Concurrent::Synchronization::TruffleLockableObject</a>
  
    <li><a href="../Concurrent/Synchronization/TruffleObject.html">Concurrent::Synchronization::TruffleObject</a>
  
    <li><a href="../Concurrent/SynchronizedDelegator.html">Concurrent::SynchronizedDelegator</a>
  
    <li><a href="../Concurrent/TVar.html">Concurrent::TVar</a>
  
    <li><a href="../Concurrent/ThreadLocalVar.html">Concurrent::ThreadLocalVar</a>
  
    <li><a href="../Concurrent/ThreadPoolExecutor.html">Concurrent::ThreadPoolExecutor</a>
  
    <li><a href="../Concurrent/ThreadSafe.html">Concurrent::ThreadSafe</a>
  
    <li><a href="../Concurrent/ThreadSafe/Util.html">Concurrent::ThreadSafe::Util</a>
  
    <li><a href="../Concurrent/ThreadSafe/Util/Adder.html">Concurrent::ThreadSafe::Util::Adder</a>
  
    <li><a href="../Concurrent/ThreadSafe/Util/CheapLockable.html">Concurrent::ThreadSafe::Util::CheapLockable</a>
  
    <li><a href="../Concurrent/ThreadSafe/Util/PowerOfTwoTuple.html">Concurrent::ThreadSafe::Util::PowerOfTwoTuple</a>
  
    <li><a href="../Concurrent/ThreadSafe/Util/Striped64.html">Concurrent::ThreadSafe::Util::Striped64</a>
  
    <li><a href="../Concurrent/ThreadSafe/Util/Striped64/Cell.html">Concurrent::ThreadSafe::Util::Striped64::Cell</a>
  
    <li><a href="../Concurrent/ThreadSafe/Util/Volatile.html">Concurrent::ThreadSafe::Util::Volatile</a>
  
    <li><a href="../Concurrent/ThreadSafe/Util/XorShiftRandom.html">Concurrent::ThreadSafe::Util::XorShiftRandom</a>
  
    <li><a href="../Concurrent/TimerSet.html">Concurrent::TimerSet</a>
  
    <li><a href="../Concurrent/TimerTask.html">Concurrent::TimerTask</a>
  
    <li><a href="../Concurrent/Transaction.html">Concurrent::Transaction</a>
  
    <li><a href="../Concurrent/Tuple.html">Concurrent::Tuple</a>
  
    <li><a href="../Concurrent/Utility.html">Concurrent::Utility</a>
  
    <li><a href="../Concurrent/Utility/EngineDetector.html">Concurrent::Utility::EngineDetector</a>
  
    <li><a href="../Concurrent/Utility/NativeExtensionLoader.html">Concurrent::Utility::NativeExtensionLoader</a>
  
    <li><a href="../Concurrent/Utility/ProcessorCounter.html">Concurrent::Utility::ProcessorCounter</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class Concurrent::TimerTask</h1>

  <div id="description" class="description">
    
<p>A very common currency pattern is to run a thread that performs a task at
regular intervals. The thread that performs the task sleeps for the given
interval then wakes up and performs the task. Lather, rinse, repeat… This
pattern causes two problems. First, it is difficult to test the business
logic of the task because the task itself is tightly coupled with the
concurrency logic. Second, an exception raised while performing the task
can cause the entire thread to abend. In a long-running application where
the task thread is intended to run for days/weeks/years a crashed task
thread can pose a significant problem. `TimerTask` alleviates both
problems.</p>

<p>When a `TimerTask` is launched it starts a thread for monitoring the
execution interval. The `TimerTask` thread does not perform the task,
however. Instead, the <a href="TimerTask.html">TimerTask</a> launches the
task on a separate thread. Should the task experience an unrecoverable
crash only the task thread will crash. This makes the `TimerTask` very
fault tolerant Additionally, the `TimerTask` thread can respond to the
success or failure of the task, performing logging or ancillary operations.
`TimerTask` can also be configured with a timeout value allowing it to kill
a task that runs too long.</p>

<p>One other advantage of `TimerTask` is that it forces the business logic to
be completely decoupled from the concurrency logic. The business logic can
be tested separately then passed to the `TimerTask` for scheduling and
running.</p>

<p>In some cases it may be necessary for a `TimerTask` to affect its own
execution cycle. To facilitate this, a reference to the <a
href="TimerTask.html">TimerTask</a> instance is passed as an argument to
the provided block every time the task is executed.</p>

<p>The `TimerTask` class includes the `Dereferenceable` mixin module so the
result of the last execution is always available via the `#value` method.
Derefencing options can be passed to the `TimerTask` during construction or
at any later time using the `#set_deref_options` method.</p>

<p>`TimerTask` supports notification through the Ruby standard library {<a
href="http://ruby-doc.org/stdlib-2.0/libdoc/observer/rdoc/Observable.html">ruby-doc.org/stdlib-2.0/libdoc/observer/rdoc/Observable.html</a>
Observable} module. On execution the `TimerTask` will notify the observers
with three arguments: time of execution, the result of the block (or nil on
failure), and any raised exceptions (or nil on success). If the timeout
interval is exceeded the observer will receive a `Concurrent::TimeoutError`
object as the third argument.</p>

<p>@!macro copy_options</p>

<p>@example Basic usage</p>

<pre class="ruby"><span class="ruby-identifier">task</span> = <span class="ruby-constant">Concurrent</span><span class="ruby-operator">::</span><span class="ruby-constant">TimerTask</span>.<span class="ruby-identifier">new</span>{ <span class="ruby-identifier">puts</span> <span class="ruby-string">&#39;Boom!&#39;</span> }
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">execute</span>

<span class="ruby-identifier">task</span>.<span class="ruby-identifier">execution_interval</span> <span class="ruby-comment">#=&gt; 60 (default)</span>
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">timeout_interval</span>   <span class="ruby-comment">#=&gt; 30 (default)</span>

<span class="ruby-comment"># wait 60 seconds...</span>
<span class="ruby-comment">#=&gt; &#39;Boom!&#39;</span>

<span class="ruby-identifier">task</span>.<span class="ruby-identifier">shutdown</span> <span class="ruby-comment">#=&gt; true</span>
</pre>

<p>@example Configuring `:execution_interval` and `:timeout_interval`</p>

<pre class="ruby"><span class="ruby-identifier">task</span> = <span class="ruby-constant">Concurrent</span><span class="ruby-operator">::</span><span class="ruby-constant">TimerTask</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">execution_interval</span><span class="ruby-operator">:</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">timeout_interval</span><span class="ruby-operator">:</span> <span class="ruby-value">5</span>) <span class="ruby-keyword">do</span>
       <span class="ruby-identifier">puts</span> <span class="ruby-string">&#39;Boom!&#39;</span>
     <span class="ruby-keyword">end</span>

<span class="ruby-identifier">task</span>.<span class="ruby-identifier">execution_interval</span> <span class="ruby-comment">#=&gt; 5</span>
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">timeout_interval</span>   <span class="ruby-comment">#=&gt; 5</span>
</pre>

<p>@example Immediate execution with `:run_now`</p>

<pre class="ruby"><span class="ruby-identifier">task</span> = <span class="ruby-constant">Concurrent</span><span class="ruby-operator">::</span><span class="ruby-constant">TimerTask</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">run_now</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>){ <span class="ruby-identifier">puts</span> <span class="ruby-string">&#39;Boom!&#39;</span> }
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">execute</span>

<span class="ruby-comment">#=&gt; &#39;Boom!&#39;</span>
</pre>

<p>@example Last `#value` and `Dereferenceable` mixin</p>

<pre class="ruby"><span class="ruby-identifier">task</span> = <span class="ruby-constant">Concurrent</span><span class="ruby-operator">::</span><span class="ruby-constant">TimerTask</span>.<span class="ruby-identifier">new</span>(
  <span class="ruby-identifier">dup_on_deref</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>,
  <span class="ruby-identifier">execution_interval</span><span class="ruby-operator">:</span> <span class="ruby-value">5</span>
){ <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> }

<span class="ruby-identifier">task</span>.<span class="ruby-identifier">execute</span>
<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>   <span class="ruby-comment">#=&gt; 2013-11-07 18:06:50 -0500</span>
<span class="ruby-identifier">sleep</span>(<span class="ruby-value">10</span>)
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">value</span> <span class="ruby-comment">#=&gt; 2013-11-07 18:06:55 -0500</span>
</pre>

<p>@example Controlling execution from within the block</p>

<pre class="ruby"><span class="ruby-identifier">timer_task</span> = <span class="ruby-constant">Concurrent</span><span class="ruby-operator">::</span><span class="ruby-constant">TimerTask</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">execution_interval</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">task</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">task</span>.<span class="ruby-identifier">execution_interval</span>.<span class="ruby-identifier">times</span>{ <span class="ruby-identifier">print</span> <span class="ruby-string">&#39;Boom! &#39;</span> }
  <span class="ruby-identifier">print</span> <span class="ruby-string">&quot;\n&quot;</span>
  <span class="ruby-identifier">task</span>.<span class="ruby-identifier">execution_interval</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">task</span>.<span class="ruby-identifier">execution_interval</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>
    <span class="ruby-identifier">puts</span> <span class="ruby-string">&#39;Stopping...&#39;</span>
    <span class="ruby-identifier">task</span>.<span class="ruby-identifier">shutdown</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">timer_task</span>.<span class="ruby-identifier">execute</span> <span class="ruby-comment"># blocking call - this task will stop itself</span>
<span class="ruby-comment">#=&gt; Boom!</span>
<span class="ruby-comment">#=&gt; Boom! Boom!</span>
<span class="ruby-comment">#=&gt; Boom! Boom! Boom!</span>
<span class="ruby-comment">#=&gt; Boom! Boom! Boom! Boom!</span>
<span class="ruby-comment">#=&gt; Boom! Boom! Boom! Boom! Boom!</span>
<span class="ruby-comment">#=&gt; Stopping...</span>
</pre>

<p>@example Observation</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">TaskObserver</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">update</span>(<span class="ruby-identifier">time</span>, <span class="ruby-identifier">result</span>, <span class="ruby-identifier">ex</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">result</span>
      <span class="ruby-identifier">print</span> <span class="ruby-node">&quot;(#{time}) Execution successfully returned #{result}\n&quot;</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">ex</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Concurrent</span><span class="ruby-operator">::</span><span class="ruby-constant">TimeoutError</span>)
      <span class="ruby-identifier">print</span> <span class="ruby-node">&quot;(#{time}) Execution timed out\n&quot;</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">print</span> <span class="ruby-node">&quot;(#{time}) Execution failed with error #{ex}\n&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">task</span> = <span class="ruby-constant">Concurrent</span><span class="ruby-operator">::</span><span class="ruby-constant">TimerTask</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">execution_interval</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">timeout_interval</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>){ <span class="ruby-value">42</span> }
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">add_observer</span>(<span class="ruby-constant">TaskObserver</span>.<span class="ruby-identifier">new</span>)
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">execute</span>

<span class="ruby-comment">#=&gt; (2013-10-13 19:08:58 -0400) Execution successfully returned 42</span>
<span class="ruby-comment">#=&gt; (2013-10-13 19:08:59 -0400) Execution successfully returned 42</span>
<span class="ruby-comment">#=&gt; (2013-10-13 19:09:00 -0400) Execution successfully returned 42</span>
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">shutdown</span>

<span class="ruby-identifier">task</span> = <span class="ruby-constant">Concurrent</span><span class="ruby-operator">::</span><span class="ruby-constant">TimerTask</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">execution_interval</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">timeout_interval</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>){ <span class="ruby-identifier">sleep</span> }
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">add_observer</span>(<span class="ruby-constant">TaskObserver</span>.<span class="ruby-identifier">new</span>)
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">execute</span>

<span class="ruby-comment">#=&gt; (2013-10-13 19:07:25 -0400) Execution timed out</span>
<span class="ruby-comment">#=&gt; (2013-10-13 19:07:27 -0400) Execution timed out</span>
<span class="ruby-comment">#=&gt; (2013-10-13 19:07:29 -0400) Execution timed out</span>
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">shutdown</span>

<span class="ruby-identifier">task</span> = <span class="ruby-constant">Concurrent</span><span class="ruby-operator">::</span><span class="ruby-constant">TimerTask</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">execution_interval</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>){ <span class="ruby-identifier">raise</span> <span class="ruby-constant">StandardError</span> }
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">add_observer</span>(<span class="ruby-constant">TaskObserver</span>.<span class="ruby-identifier">new</span>)
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">execute</span>

<span class="ruby-comment">#=&gt; (2013-10-13 19:09:37 -0400) Execution failed with error StandardError</span>
<span class="ruby-comment">#=&gt; (2013-10-13 19:09:38 -0400) Execution failed with error StandardError</span>
<span class="ruby-comment">#=&gt; (2013-10-13 19:09:39 -0400) Execution failed with error StandardError</span>
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">shutdown</span>
</pre>

<p>@see <a
href="http://ruby-doc.org/stdlib-2.0/libdoc/observer/rdoc/Observable.html">ruby-doc.org/stdlib-2.0/libdoc/observer/rdoc/Observable.html</a>
@see <a
href="http://docs.oracle.com/javase/7/docs/api/java/util/TimerTask.html">docs.oracle.com/javase/7/docs/api/java/util/TimerTask.html</a></p>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <!-- Constants -->
    <section id="constants-list" class="section">
      <h3 class="section-header">Constants</h3>
      <dl>
      
        <dt id="EXECUTION_INTERVAL">EXECUTION_INTERVAL
        
        <dd class="description"><p>Default `:execution_interval` in seconds.</p>
        
      
        <dt id="TIMEOUT_INTERVAL">TIMEOUT_INTERVAL
        
        <dd class="description"><p>Default `:timeout_interval` in seconds.</p>
        
      
      </dl>
    </section>
    

    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-execute" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">execute</span><span
            class="method-args">(opts = {}, &task)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Create and execute a new `TimerTask`.</p>

<p>@!macro timer_task_initialize</p>

<p>@example</p>

<pre class="ruby"><span class="ruby-identifier">task</span> = <span class="ruby-constant">Concurrent</span><span class="ruby-operator">::</span><span class="ruby-constant">TimerTask</span>.<span class="ruby-identifier">execute</span>(<span class="ruby-identifier">execution_interval</span><span class="ruby-operator">:</span> <span class="ruby-value">10</span>){ <span class="ruby-identifier">print</span> <span class="ruby-string">&quot;Hello World\n&quot;</span> }
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">running?</span> <span class="ruby-comment">#=&gt; true</span>
</pre>
          
          

          
          <div class="method-source-code" id="execute-source">
            <pre><span class="ruby-comment"># File lib/concurrent/timer_task.rb, line 231</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">execute</span>(<span class="ruby-identifier">opts</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">task</span>)
  <span class="ruby-constant">TimerTask</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">task</span>).<span class="ruby-identifier">execute</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- execute-source -->
          
        </div>

        

        
      </div><!-- execute-method -->

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(opts = {}, &task)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Create a new <a href="TimerTask.html">TimerTask</a> with the given task and
configuration.</p>

<p>@!macro [attach] timer_task_initialize</p>

<pre>@param [Hash] opts the options defining task execution.
@option opts [Integer] :execution_interval number of seconds between
  task executions (default: EXECUTION_INTERVAL)
@option opts [Integer] :timeout_interval number of seconds a task can
  run before it is considered to have failed (default: TIMEOUT_INTERVAL)
@option opts [Boolean] :run_now Whether to run the task immediately
  upon instantiation or to wait until the first #  execution_interval
  has passed (default: false)

@!macro deref_options

@raise ArgumentError when no block is given.

@yield to the block after :execution_interval seconds have passed since
  the last yield
@yieldparam task a reference to the `TimerTask` instance so that the
  block can control its own lifecycle. Necessary since `self` will
  refer to the execution context of the block rather than the running
  `TimerTask`.

@return [TimerTask] the new `TimerTask`</pre>
          
          
            <div class="method-calls-super">
              Calls superclass method
              <a href="RubyExecutorService.html#method-c-new">Concurrent::RubyExecutorService.new</a>
            </div>
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/concurrent/timer_task.rb, line 189</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">opts</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">task</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;no block given&#39;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-keyword">super</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- new-source -->
          
        </div>

        

        
      </div><!-- new-method -->

    
    </section><!-- public-class-method-details -->
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-execute" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">execute</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Execute a previously created `TimerTask`.</p>

<p>@return [TimerTask] a reference to `self`</p>

<p>@example Instance and execute in separate steps</p>

<pre class="ruby"><span class="ruby-identifier">task</span> = <span class="ruby-constant">Concurrent</span><span class="ruby-operator">::</span><span class="ruby-constant">TimerTask</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">execution_interval</span><span class="ruby-operator">:</span> <span class="ruby-value">10</span>){ <span class="ruby-identifier">print</span> <span class="ruby-string">&quot;Hello World\n&quot;</span> }
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">running?</span> <span class="ruby-comment">#=&gt; false</span>
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">execute</span>
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">running?</span> <span class="ruby-comment">#=&gt; true</span>
</pre>

<p>@example Instance and execute in one line</p>

<pre class="ruby"><span class="ruby-identifier">task</span> = <span class="ruby-constant">Concurrent</span><span class="ruby-operator">::</span><span class="ruby-constant">TimerTask</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">execution_interval</span><span class="ruby-operator">:</span> <span class="ruby-value">10</span>){ <span class="ruby-identifier">print</span> <span class="ruby-string">&quot;Hello World\n&quot;</span> }.<span class="ruby-identifier">execute</span>
<span class="ruby-identifier">task</span>.<span class="ruby-identifier">running?</span> <span class="ruby-comment">#=&gt; true</span>
</pre>
          
          

          
          <div class="method-source-code" id="execute-source">
            <pre><span class="ruby-comment"># File lib/concurrent/timer_task.rb, line 214</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">execute</span>
  <span class="ruby-identifier">synchronize</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@running</span>.<span class="ruby-identifier">false?</span>
      <span class="ruby-ivar">@running</span>.<span class="ruby-identifier">make_true</span>
      <span class="ruby-identifier">schedule_next_task</span>(<span class="ruby-ivar">@run_now</span> <span class="ruby-operator">?</span> <span class="ruby-value">0</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@execution_interval</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- execute-source -->
          
        </div>

        

        
      </div><!-- execute-method -->

    
      <div id="method-i-execution_interval" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">execution_interval</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@!attribute [rw] <a
href="TimerTask.html#method-i-execution_interval">#execution_interval</a>
@return [Fixnum] Number of seconds after the task completes before the</p>

<pre>task is performed again.</pre>
          
          

          
          <div class="method-source-code" id="execution_interval-source">
            <pre><span class="ruby-comment"># File lib/concurrent/timer_task.rb, line 238</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">execution_interval</span>
  <span class="ruby-identifier">synchronize</span> { <span class="ruby-ivar">@execution_interval</span> }
<span class="ruby-keyword">end</span></pre>
          </div><!-- execution_interval-source -->
          
        </div>

        

        
      </div><!-- execution_interval-method -->

    
      <div id="method-i-execution_interval-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">execution_interval=</span><span
            class="method-args">(value)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@!attribute [rw] <a
href="TimerTask.html#method-i-execution_interval">#execution_interval</a>
@return [Fixnum] Number of seconds after the task completes before the</p>

<pre>task is performed again.</pre>
          
          

          
          <div class="method-source-code" id="execution_interval-3D-source">
            <pre><span class="ruby-comment"># File lib/concurrent/timer_task.rb, line 245</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">execution_interval=</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">value</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_f</span>) <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0.0</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;must be greater than zero&#39;</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">synchronize</span> { <span class="ruby-ivar">@execution_interval</span> = <span class="ruby-identifier">value</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- execution_interval-3D-source -->
          
        </div>

        

        
      </div><!-- execution_interval-3D-method -->

    
      <div id="method-i-running-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">running?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Is the executor running?</p>

<p>@return [Boolean] `true` when running, `false` when shutting down or
shutdown</p>
          
          

          
          <div class="method-source-code" id="running-3F-source">
            <pre><span class="ruby-comment"># File lib/concurrent/timer_task.rb, line 197</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">running?</span>
  <span class="ruby-ivar">@running</span>.<span class="ruby-identifier">true?</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- running-3F-source -->
          
        </div>

        

        
      </div><!-- running-3F-method -->

    
      <div id="method-i-timeout_interval" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">timeout_interval</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@!attribute [rw] <a
href="TimerTask.html#method-i-timeout_interval">#timeout_interval</a>
@return [Fixnum] Number of seconds the task can run before it is</p>

<pre>considered to have failed.</pre>
          
          

          
          <div class="method-source-code" id="timeout_interval-source">
            <pre><span class="ruby-comment"># File lib/concurrent/timer_task.rb, line 256</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">timeout_interval</span>
  <span class="ruby-identifier">synchronize</span> { <span class="ruby-ivar">@timeout_interval</span> }
<span class="ruby-keyword">end</span></pre>
          </div><!-- timeout_interval-source -->
          
        </div>

        

        
      </div><!-- timeout_interval-method -->

    
      <div id="method-i-timeout_interval-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">timeout_interval=</span><span
            class="method-args">(value)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@!attribute [rw] <a
href="TimerTask.html#method-i-timeout_interval">#timeout_interval</a>
@return [Fixnum] Number of seconds the task can run before it is</p>

<pre>considered to have failed.</pre>
          
          

          
          <div class="method-source-code" id="timeout_interval-3D-source">
            <pre><span class="ruby-comment"># File lib/concurrent/timer_task.rb, line 263</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">timeout_interval=</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">value</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_f</span>) <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0.0</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;must be greater than zero&#39;</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">synchronize</span> { <span class="ruby-ivar">@timeout_interval</span> = <span class="ruby-identifier">value</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- timeout_interval-3D-source -->
          
        </div>

        

        
      </div><!-- timeout_interval-3D-method -->

    
    </section><!-- public-instance-method-details -->
  
     <section id="private-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Private Instance Methods</h3>

    
      <div id="method-i-execute_task" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">execute_task</span><span
            class="method-args">(completion)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@!visibility private</p>
          
          

          
          <div class="method-source-code" id="execute_task-source">
            <pre><span class="ruby-comment"># File lib/concurrent/timer_task.rb, line 306</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">execute_task</span>(<span class="ruby-identifier">completion</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@running</span>.<span class="ruby-identifier">true?</span>
  <span class="ruby-constant">ScheduledTask</span>.<span class="ruby-identifier">execute</span>(<span class="ruby-identifier">execution_interval</span>, <span class="ruby-identifier">args</span><span class="ruby-operator">:</span> [<span class="ruby-identifier">completion</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-value">:timeout_task</span>))
  <span class="ruby-identifier">_success</span>, <span class="ruby-identifier">value</span>, <span class="ruby-identifier">reason</span> = <span class="ruby-ivar">@executor</span>.<span class="ruby-identifier">execute</span>(<span class="ruby-keyword">self</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">completion</span>.<span class="ruby-identifier">try?</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">value</span> = <span class="ruby-identifier">value</span>
    <span class="ruby-identifier">schedule_next_task</span>
    <span class="ruby-identifier">time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
    <span class="ruby-identifier">observers</span>.<span class="ruby-identifier">notify_observers</span> <span class="ruby-keyword">do</span>
      [<span class="ruby-identifier">time</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">value</span>, <span class="ruby-identifier">reason</span>]
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- execute_task-source -->
          
        </div>

        

        
      </div><!-- execute_task-method -->

    
      <div id="method-i-ns_initialize" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">ns_initialize</span><span
            class="method-args">(opts, &task)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="ns_initialize-source">
            <pre><span class="ruby-comment"># File lib/concurrent/timer_task.rb, line 275</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ns_initialize</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">task</span>)
  <span class="ruby-identifier">set_deref_options</span>(<span class="ruby-identifier">opts</span>)

  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">execution_interval</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:execution</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:execution_interval</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">EXECUTION_INTERVAL</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">timeout_interval</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:timeout</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:timeout_interval</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">TIMEOUT_INTERVAL</span>
  <span class="ruby-ivar">@run_now</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:now</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:run_now</span>]
  <span class="ruby-ivar">@executor</span> = <span class="ruby-constant">Concurrent</span><span class="ruby-operator">::</span><span class="ruby-constant">SafeTaskExecutor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">task</span>)
  <span class="ruby-ivar">@running</span> = <span class="ruby-constant">Concurrent</span><span class="ruby-operator">::</span><span class="ruby-constant">AtomicBoolean</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">false</span>)

  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">observers</span> = <span class="ruby-constant">Collection</span><span class="ruby-operator">::</span><span class="ruby-constant">CopyOnNotifyObserverSet</span>.<span class="ruby-identifier">new</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- ns_initialize-source -->
          
        </div>

        

        
      </div><!-- ns_initialize-method -->

    
      <div id="method-i-ns_kill_execution" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">ns_kill_execution</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@!visibility private</p>
          
          
            <div class="method-calls-super">
              Calls superclass method
              <a href="AbstractExecutorService.html#method-i-ns_kill_execution">Concurrent::AbstractExecutorService#ns_kill_execution</a>
            </div>
          

          
          <div class="method-source-code" id="ns_kill_execution-source">
            <pre><span class="ruby-comment"># File lib/concurrent/timer_task.rb, line 294</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ns_kill_execution</span>
  <span class="ruby-ivar">@running</span>.<span class="ruby-identifier">make_false</span>
  <span class="ruby-keyword">super</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- ns_kill_execution-source -->
          
        </div>

        

        
      </div><!-- ns_kill_execution-method -->

    
      <div id="method-i-ns_shutdown_execution" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">ns_shutdown_execution</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@!visibility private</p>
          
          
            <div class="method-calls-super">
              Calls superclass method
              <a href="RubyExecutorService.html#method-i-ns_shutdown_execution">Concurrent::RubyExecutorService#ns_shutdown_execution</a>
            </div>
          

          
          <div class="method-source-code" id="ns_shutdown_execution-source">
            <pre><span class="ruby-comment"># File lib/concurrent/timer_task.rb, line 288</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ns_shutdown_execution</span>
  <span class="ruby-ivar">@running</span>.<span class="ruby-identifier">make_false</span>
  <span class="ruby-keyword">super</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- ns_shutdown_execution-source -->
          
        </div>

        

        
      </div><!-- ns_shutdown_execution-method -->

    
      <div id="method-i-schedule_next_task" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">schedule_next_task</span><span
            class="method-args">(interval = execution_interval)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@!visibility private</p>
          
          

          
          <div class="method-source-code" id="schedule_next_task-source">
            <pre><span class="ruby-comment"># File lib/concurrent/timer_task.rb, line 300</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">schedule_next_task</span>(<span class="ruby-identifier">interval</span> = <span class="ruby-identifier">execution_interval</span>)
  <span class="ruby-constant">ScheduledTask</span>.<span class="ruby-identifier">execute</span>(<span class="ruby-identifier">interval</span>, <span class="ruby-identifier">args</span><span class="ruby-operator">:</span> [<span class="ruby-constant">Concurrent</span><span class="ruby-operator">::</span><span class="ruby-constant">Event</span>.<span class="ruby-identifier">new</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-value">:execute_task</span>))
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- schedule_next_task-source -->
          
        </div>

        

        
      </div><!-- schedule_next_task-method -->

    
      <div id="method-i-timeout_task" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">timeout_task</span><span
            class="method-args">(completion)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@!visibility private</p>
          
          

          
          <div class="method-source-code" id="timeout_task-source">
            <pre><span class="ruby-comment"># File lib/concurrent/timer_task.rb, line 322</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">timeout_task</span>(<span class="ruby-identifier">completion</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@running</span>.<span class="ruby-identifier">true?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">completion</span>.<span class="ruby-identifier">try?</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">value</span> = <span class="ruby-identifier">value</span>
    <span class="ruby-identifier">schedule_next_task</span>
    <span class="ruby-identifier">observers</span>.<span class="ruby-identifier">notify_observers</span>(<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>, <span class="ruby-keyword">nil</span>, <span class="ruby-constant">Concurrent</span><span class="ruby-operator">::</span><span class="ruby-constant">TimeoutError</span>.<span class="ruby-identifier">new</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- timeout_task-source -->
          
        </div>

        

        
      </div><!-- timeout_task-method -->

    
    </section><!-- private-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 4.0.0.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

