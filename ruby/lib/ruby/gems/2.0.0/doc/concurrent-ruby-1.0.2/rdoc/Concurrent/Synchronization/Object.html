<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>class Concurrent::Synchronization::Object - concurrent-ruby-1.0.2 Documentation</title>

<link type="text/css" media="screen" href="../../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../../index.html">Home</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  

  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/concurrent/synchronization/object.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link">ObjectImplementation
  
</nav>

    
    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li ><a href="#method-c-attr_atomic">::attr_atomic</a>
    
    <li ><a href="#method-c-define_initialize_volatile_with_cas">::define_initialize_volatile_with_cas</a>
    
    <li ><a href="#method-c-ensure_safe_initialization_when_final_fields_are_present">::ensure_safe_initialization_when_final_fields_are_present</a>
    
    <li class="calls-super" ><a href="#method-c-new">::new</a>
    
    <li class="calls-super" ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-c-safe_initialization-21">::safe_initialization!</a>
    
    <li ><a href="#method-c-safe_initialization-3F">::safe_initialization?</a>
    
    <li ><a href="#method-c-volatile_cas_fields">::volatile_cas_fields</a>
    
    <li ><a href="#method-i-initialize_volatile_with_cas">#initialize_volatile_with_cas</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="../../CHANGELOG_md.html">CHANGELOG</a>
  
    <li class="file"><a href="../../LICENSE_txt.html">LICENSE</a>
  
    <li class="file"><a href="../../README_md.html">README</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../../Concurrent.html">Concurrent</a>
  
    <li><a href="../../Concurrent/AbstractExchanger.html">Concurrent::AbstractExchanger</a>
  
    <li><a href="../../Concurrent/AbstractExecutorService.html">Concurrent::AbstractExecutorService</a>
  
    <li><a href="../../Concurrent/AbstractThreadLocalVar.html">Concurrent::AbstractThreadLocalVar</a>
  
    <li><a href="../../Concurrent/Agent.html">Concurrent::Agent</a>
  
    <li><a href="../../Concurrent/Agent/Error.html">Concurrent::Agent::Error</a>
  
    <li><a href="../../Concurrent/Agent/ValidationError.html">Concurrent::Agent::ValidationError</a>
  
    <li><a href="../../Concurrent/Array.html">Concurrent::Array</a>
  
    <li><a href="../../Concurrent/Async.html">Concurrent::Async</a>
  
    <li><a href="../../Concurrent/Async/AsyncDelegator.html">Concurrent::Async::AsyncDelegator</a>
  
    <li><a href="../../Concurrent/Async/AwaitDelegator.html">Concurrent::Async::AwaitDelegator</a>
  
    <li><a href="../../Concurrent/Async/ClassMethods.html">Concurrent::Async::ClassMethods</a>
  
    <li><a href="../../Concurrent/AtExitImplementation.html">Concurrent::AtExitImplementation</a>
  
    <li><a href="../../Concurrent/Atom.html">Concurrent::Atom</a>
  
    <li><a href="../../Concurrent/AtomicBoolean.html">Concurrent::AtomicBoolean</a>
  
    <li><a href="../../Concurrent/AtomicDirectUpdate.html">Concurrent::AtomicDirectUpdate</a>
  
    <li><a href="../../Concurrent/AtomicFixnum.html">Concurrent::AtomicFixnum</a>
  
    <li><a href="../../Concurrent/AtomicNumericCompareAndSetWrapper.html">Concurrent::AtomicNumericCompareAndSetWrapper</a>
  
    <li><a href="../../Concurrent/AtomicReference.html">Concurrent::AtomicReference</a>
  
    <li><a href="../../Concurrent/CAtomicReference.html">Concurrent::CAtomicReference</a>
  
    <li><a href="../../Concurrent/CachedThreadPool.html">Concurrent::CachedThreadPool</a>
  
    <li><a href="../../Concurrent/Collection.html">Concurrent::Collection</a>
  
    <li><a href="../../Concurrent/Collection/AtomicReferenceMapBackend.html">Concurrent::Collection::AtomicReferenceMapBackend</a>
  
    <li><a href="../../Concurrent/Collection/AtomicReferenceMapBackend/Node.html">Concurrent::Collection::AtomicReferenceMapBackend::Node</a>
  
    <li><a href="../../Concurrent/Collection/AtomicReferenceMapBackend/Table.html">Concurrent::Collection::AtomicReferenceMapBackend::Table</a>
  
    <li><a href="../../Concurrent/Collection/CopyOnNotifyObserverSet.html">Concurrent::Collection::CopyOnNotifyObserverSet</a>
  
    <li><a href="../../Concurrent/Collection/CopyOnWriteObserverSet.html">Concurrent::Collection::CopyOnWriteObserverSet</a>
  
    <li><a href="../../Concurrent/Collection/JavaNonConcurrentPriorityQueue.html">Concurrent::Collection::JavaNonConcurrentPriorityQueue</a>
  
    <li><a href="../../Concurrent/Collection/MriMapBackend.html">Concurrent::Collection::MriMapBackend</a>
  
    <li><a href="../../Concurrent/Collection/NonConcurrentMapBackend.html">Concurrent::Collection::NonConcurrentMapBackend</a>
  
    <li><a href="../../Concurrent/Collection/NonConcurrentPriorityQueue.html">Concurrent::Collection::NonConcurrentPriorityQueue</a>
  
    <li><a href="../../Concurrent/Collection/RubyNonConcurrentPriorityQueue.html">Concurrent::Collection::RubyNonConcurrentPriorityQueue</a>
  
    <li><a href="../../Concurrent/Collection/SynchronizedMapBackend.html">Concurrent::Collection::SynchronizedMapBackend</a>
  
    <li><a href="../../Concurrent/Concern.html">Concurrent::Concern</a>
  
    <li><a href="../../Concurrent/Concern/Deprecation.html">Concurrent::Concern::Deprecation</a>
  
    <li><a href="../../Concurrent/Concern/Dereferenceable.html">Concurrent::Concern::Dereferenceable</a>
  
    <li><a href="../../Concurrent/Concern/Logging.html">Concurrent::Concern::Logging</a>
  
    <li><a href="../../Concurrent/Concern/Obligation.html">Concurrent::Concern::Obligation</a>
  
    <li><a href="../../Concurrent/Concern/Observable.html">Concurrent::Concern::Observable</a>
  
    <li><a href="../../Concurrent/ConcurrentUpdateError.html">Concurrent::ConcurrentUpdateError</a>
  
    <li><a href="../../Concurrent/CountDownLatch.html">Concurrent::CountDownLatch</a>
  
    <li><a href="../../Concurrent/CyclicBarrier.html">Concurrent::CyclicBarrier</a>
  
    <li><a href="../../Concurrent/Delay.html">Concurrent::Delay</a>
  
    <li><a href="../../Concurrent/DependencyCounter.html">Concurrent::DependencyCounter</a>
  
    <li><a href="../../Concurrent/Edge.html">Concurrent::Edge</a>
  
    <li><a href="../../Concurrent/Event.html">Concurrent::Event</a>
  
    <li><a href="../../Concurrent/Exchanger.html">Concurrent::Exchanger</a>
  
    <li><a href="../../Concurrent/ExecutorService.html">Concurrent::ExecutorService</a>
  
    <li><a href="../../Concurrent/FixedThreadPool.html">Concurrent::FixedThreadPool</a>
  
    <li><a href="../../Concurrent/Future.html">Concurrent::Future</a>
  
    <li><a href="../../Concurrent/Hash.html">Concurrent::Hash</a>
  
    <li><a href="../../Concurrent/IVar.html">Concurrent::IVar</a>
  
    <li><a href="../../Concurrent/ImmediateExecutor.html">Concurrent::ImmediateExecutor</a>
  
    <li><a href="../../Concurrent/ImmutableStruct.html">Concurrent::ImmutableStruct</a>
  
    <li><a href="../../Concurrent/IndirectImmediateExecutor.html">Concurrent::IndirectImmediateExecutor</a>
  
    <li><a href="../../Concurrent/JavaAtomicReference.html">Concurrent::JavaAtomicReference</a>
  
    <li><a href="../../Concurrent/JavaCountDownLatch.html">Concurrent::JavaCountDownLatch</a>
  
    <li><a href="../../Concurrent/JavaExchanger.html">Concurrent::JavaExchanger</a>
  
    <li><a href="../../Concurrent/JavaExecutorService.html">Concurrent::JavaExecutorService</a>
  
    <li><a href="../../Concurrent/JavaExecutorService/Job.html">Concurrent::JavaExecutorService::Job</a>
  
    <li><a href="../../Concurrent/JavaSingleThreadExecutor.html">Concurrent::JavaSingleThreadExecutor</a>
  
    <li><a href="../../Concurrent/JavaThreadLocalVar.html">Concurrent::JavaThreadLocalVar</a>
  
    <li><a href="../../Concurrent/JavaThreadPoolExecutor.html">Concurrent::JavaThreadPoolExecutor</a>
  
    <li><a href="../../Concurrent/LazyRegister.html">Concurrent::LazyRegister</a>
  
    <li><a href="../../Concurrent/MVar.html">Concurrent::MVar</a>
  
    <li><a href="../../Concurrent/Map.html">Concurrent::Map</a>
  
    <li><a href="../../Concurrent/Maybe.html">Concurrent::Maybe</a>
  
    <li><a href="../../Concurrent/MutableStruct.html">Concurrent::MutableStruct</a>
  
    <li><a href="../../Concurrent/MutexAtomicBoolean.html">Concurrent::MutexAtomicBoolean</a>
  
    <li><a href="../../Concurrent/MutexAtomicFixnum.html">Concurrent::MutexAtomicFixnum</a>
  
    <li><a href="../../Concurrent/MutexAtomicReference.html">Concurrent::MutexAtomicReference</a>
  
    <li><a href="../../Concurrent/MutexCountDownLatch.html">Concurrent::MutexCountDownLatch</a>
  
    <li><a href="../../Concurrent/MutexSemaphore.html">Concurrent::MutexSemaphore</a>
  
    <li><a href="../../Concurrent/Options.html">Concurrent::Options</a>
  
    <li><a href="../../Concurrent/Process.html">Concurrent::Process</a>
  
    <li><a href="../../Concurrent/Promise.html">Concurrent::Promise</a>
  
    <li><a href="../../Concurrent/RbxAtomicReference.html">Concurrent::RbxAtomicReference</a>
  
    <li><a href="../../Concurrent/ReadWriteLock.html">Concurrent::ReadWriteLock</a>
  
    <li><a href="../../Concurrent/ReentrantReadWriteLock.html">Concurrent::ReentrantReadWriteLock</a>
  
    <li><a href="../../Concurrent/RubyExchanger.html">Concurrent::RubyExchanger</a>
  
    <li><a href="../../Concurrent/RubyExchanger/Node.html">Concurrent::RubyExchanger::Node</a>
  
    <li><a href="../../Concurrent/RubyExecutorService.html">Concurrent::RubyExecutorService</a>
  
    <li><a href="../../Concurrent/RubySingleThreadExecutor.html">Concurrent::RubySingleThreadExecutor</a>
  
    <li><a href="../../Concurrent/RubyThreadLocalVar.html">Concurrent::RubyThreadLocalVar</a>
  
    <li><a href="../../Concurrent/RubyThreadPoolExecutor.html">Concurrent::RubyThreadPoolExecutor</a>
  
    <li><a href="../../Concurrent/RubyThreadPoolExecutor/Worker.html">Concurrent::RubyThreadPoolExecutor::Worker</a>
  
    <li><a href="../../Concurrent/SafeTaskExecutor.html">Concurrent::SafeTaskExecutor</a>
  
    <li><a href="../../Concurrent/ScheduledTask.html">Concurrent::ScheduledTask</a>
  
    <li><a href="../../Concurrent/Semaphore.html">Concurrent::Semaphore</a>
  
    <li><a href="../../Concurrent/SerialExecutorService.html">Concurrent::SerialExecutorService</a>
  
    <li><a href="../../Concurrent/SerializedExecution.html">Concurrent::SerializedExecution</a>
  
    <li><a href="../../Concurrent/SerializedExecutionDelegator.html">Concurrent::SerializedExecutionDelegator</a>
  
    <li><a href="../../Concurrent/SettableStruct.html">Concurrent::SettableStruct</a>
  
    <li><a href="../../Concurrent/SimpleExecutorService.html">Concurrent::SimpleExecutorService</a>
  
    <li><a href="../../Concurrent/SingleThreadExecutor.html">Concurrent::SingleThreadExecutor</a>
  
    <li><a href="../../Concurrent/Synchronization.html">Concurrent::Synchronization</a>
  
    <li><a href="../../Concurrent/Synchronization/AbstractLockableObject.html">Concurrent::Synchronization::AbstractLockableObject</a>
  
    <li><a href="../../Concurrent/Synchronization/AbstractObject.html">Concurrent::Synchronization::AbstractObject</a>
  
    <li><a href="../../Concurrent/Synchronization/AbstractStruct.html">Concurrent::Synchronization::AbstractStruct</a>
  
    <li><a href="../../Concurrent/Synchronization/Condition.html">Concurrent::Synchronization::Condition</a>
  
    <li><a href="../../Concurrent/Synchronization/JRubyAttrVolatile.html">Concurrent::Synchronization::JRubyAttrVolatile</a>
  
    <li><a href="../../Concurrent/Synchronization/JRubyAttrVolatile/ClassMethods.html">Concurrent::Synchronization::JRubyAttrVolatile::ClassMethods</a>
  
    <li><a href="../../Concurrent/Synchronization/JRubyLockableObject.html">Concurrent::Synchronization::JRubyLockableObject</a>
  
    <li><a href="../../Concurrent/Synchronization/JRubyObject.html">Concurrent::Synchronization::JRubyObject</a>
  
    <li><a href="../../Concurrent/Synchronization/Lock.html">Concurrent::Synchronization::Lock</a>
  
    <li><a href="../../Concurrent/Synchronization/LockableObject.html">Concurrent::Synchronization::LockableObject</a>
  
    <li><a href="../../Concurrent/Synchronization/MriAttrVolatile.html">Concurrent::Synchronization::MriAttrVolatile</a>
  
    <li><a href="../../Concurrent/Synchronization/MriAttrVolatile/ClassMethods.html">Concurrent::Synchronization::MriAttrVolatile::ClassMethods</a>
  
    <li><a href="../../Concurrent/Synchronization/MriLockableObject.html">Concurrent::Synchronization::MriLockableObject</a>
  
    <li><a href="../../Concurrent/Synchronization/MriMonitorLockableObject.html">Concurrent::Synchronization::MriMonitorLockableObject</a>
  
    <li><a href="../../Concurrent/Synchronization/MriMutexLockableObject.html">Concurrent::Synchronization::MriMutexLockableObject</a>
  
    <li><a href="../../Concurrent/Synchronization/MriObject.html">Concurrent::Synchronization::MriObject</a>
  
    <li><a href="../../Concurrent/Synchronization/Object.html">Concurrent::Synchronization::Object</a>
  
    <li><a href="../../Concurrent/Synchronization/RbxAttrVolatile.html">Concurrent::Synchronization::RbxAttrVolatile</a>
  
    <li><a href="../../Concurrent/Synchronization/RbxAttrVolatile/ClassMethods.html">Concurrent::Synchronization::RbxAttrVolatile::ClassMethods</a>
  
    <li><a href="../../Concurrent/Synchronization/RbxLockableObject.html">Concurrent::Synchronization::RbxLockableObject</a>
  
    <li><a href="../../Concurrent/Synchronization/RbxObject.html">Concurrent::Synchronization::RbxObject</a>
  
    <li><a href="../../Concurrent/Synchronization/TruffleAttrVolatile.html">Concurrent::Synchronization::TruffleAttrVolatile</a>
  
    <li><a href="../../Concurrent/Synchronization/TruffleAttrVolatile/ClassMethods.html">Concurrent::Synchronization::TruffleAttrVolatile::ClassMethods</a>
  
    <li><a href="../../Concurrent/Synchronization/TruffleLockableObject.html">Concurrent::Synchronization::TruffleLockableObject</a>
  
    <li><a href="../../Concurrent/Synchronization/TruffleObject.html">Concurrent::Synchronization::TruffleObject</a>
  
    <li><a href="../../Concurrent/SynchronizedDelegator.html">Concurrent::SynchronizedDelegator</a>
  
    <li><a href="../../Concurrent/TVar.html">Concurrent::TVar</a>
  
    <li><a href="../../Concurrent/ThreadLocalVar.html">Concurrent::ThreadLocalVar</a>
  
    <li><a href="../../Concurrent/ThreadPoolExecutor.html">Concurrent::ThreadPoolExecutor</a>
  
    <li><a href="../../Concurrent/ThreadSafe.html">Concurrent::ThreadSafe</a>
  
    <li><a href="../../Concurrent/ThreadSafe/Util.html">Concurrent::ThreadSafe::Util</a>
  
    <li><a href="../../Concurrent/ThreadSafe/Util/Adder.html">Concurrent::ThreadSafe::Util::Adder</a>
  
    <li><a href="../../Concurrent/ThreadSafe/Util/CheapLockable.html">Concurrent::ThreadSafe::Util::CheapLockable</a>
  
    <li><a href="../../Concurrent/ThreadSafe/Util/PowerOfTwoTuple.html">Concurrent::ThreadSafe::Util::PowerOfTwoTuple</a>
  
    <li><a href="../../Concurrent/ThreadSafe/Util/Striped64.html">Concurrent::ThreadSafe::Util::Striped64</a>
  
    <li><a href="../../Concurrent/ThreadSafe/Util/Striped64/Cell.html">Concurrent::ThreadSafe::Util::Striped64::Cell</a>
  
    <li><a href="../../Concurrent/ThreadSafe/Util/Volatile.html">Concurrent::ThreadSafe::Util::Volatile</a>
  
    <li><a href="../../Concurrent/ThreadSafe/Util/XorShiftRandom.html">Concurrent::ThreadSafe::Util::XorShiftRandom</a>
  
    <li><a href="../../Concurrent/TimerSet.html">Concurrent::TimerSet</a>
  
    <li><a href="../../Concurrent/TimerTask.html">Concurrent::TimerTask</a>
  
    <li><a href="../../Concurrent/Transaction.html">Concurrent::Transaction</a>
  
    <li><a href="../../Concurrent/Tuple.html">Concurrent::Tuple</a>
  
    <li><a href="../../Concurrent/Utility.html">Concurrent::Utility</a>
  
    <li><a href="../../Concurrent/Utility/EngineDetector.html">Concurrent::Utility::EngineDetector</a>
  
    <li><a href="../../Concurrent/Utility/NativeExtensionLoader.html">Concurrent::Utility::NativeExtensionLoader</a>
  
    <li><a href="../../Concurrent/Utility/ProcessorCounter.html">Concurrent::Utility::ProcessorCounter</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class Concurrent::Synchronization::Object</h1>

  <div id="description" class="description">
    
<p>Abstract object providing final, volatile, ans CAS extensions to build
other concurrent abstractions.</p>
<ul><li>
<p>final instance variables see {Object.safe_initialization!}</p>
</li><li>
<p>volatile instance variables see {Object.attr_volatile}</p>
</li><li>
<p>volatile instance variables see {Object.attr_atomic}</p>
</li></ul>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-attr_atomic" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">attr_atomic</span><span
            class="method-args">(*names)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Creates methods for reading and writing to a instance variable with
volatile (Java) semantic as {.attr_volatile} does. The instance variable
should be accessed oly through generated methods. This method generates
following methods: `value`, `value=(new_value) #=&gt; new_value`,
`swap_value(new_value) #=&gt; old_value`, `compare_and_set_value(expected,
value) #=&gt; true || false`, `update_value(&amp;block)`. @param
[Array&lt;Symbol&gt;] names of the instance variables to be volatile with
CAS. @return [Array&lt;Symbol&gt;] names of defined method names.</p>
          
          

          
          <div class="method-source-code" id="attr_atomic-source">
            <pre><span class="ruby-comment"># File lib/concurrent/synchronization/object.rb, line 92</span>
      <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">attr_atomic</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">names</span>)
        <span class="ruby-ivar">@volatile_cas_fields</span> <span class="ruby-operator">||=</span> []
        <span class="ruby-ivar">@volatile_cas_fields</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">names</span>
        <span class="ruby-identifier">safe_initialization!</span>
        <span class="ruby-identifier">define_initialize_volatile_with_cas</span>

        <span class="ruby-identifier">names</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">ivar</span> = <span class="ruby-value">:&quot;@Atomic#{name.to_s.gsub(/(?:^|_)(.)/) { $1.upcase }}&quot;</span>
          <span class="ruby-identifier">class_eval</span> <span class="ruby-string">&quot;            def #{name}
              #{ivar}.get
            end

            def #{name}=(value)
              #{ivar}.set value
            end

            def swap_#{name}(value)
              #{ivar}.swap value
            end

            def compare_and_set_#{name}(expected, value)
              #{ivar}.compare_and_set expected, value
            end

            def update_#{name}(&amp;block)
              #{ivar}.update(&amp;block)
            end
&quot;</span>, <span class="ruby-keyword">__FILE__</span>, <span class="ruby-keyword">__LINE__</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">names</span>.<span class="ruby-identifier">flat_map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span> [<span class="ruby-identifier">n</span>, <span class="ruby-value">:&quot;#{n}=&quot;</span>, <span class="ruby-value">:&quot;swap_#{n}&quot;</span>, <span class="ruby-value">:&quot;compare_and_set_#{n}&quot;</span>, <span class="ruby-value">:&quot;update_#{n}&quot;</span>] }
      <span class="ruby-keyword">end</span></pre>
          </div><!-- attr_atomic-source -->
          
        </div>

        

        
      </div><!-- attr_atomic-method -->

    
      <div id="method-c-ensure_safe_initialization_when_final_fields_are_present" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">ensure_safe_initialization_when_final_fields_are_present</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>For testing purposes, quite slow. Injects assert code to new method which
will raise if class instance contains any instance variables with CamelCase
names and isn&#39;t {.safe_initialization?}.</p>
          
          

          
          <div class="method-source-code" id="ensure_safe_initialization_when_final_fields_are_present-source">
            <pre><span class="ruby-comment"># File lib/concurrent/synchronization/object.rb, line 71</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">ensure_safe_initialization_when_final_fields_are_present</span>
  <span class="ruby-constant">Object</span>.<span class="ruby-identifier">class_eval</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">new</span>(<span class="ruby-operator">*</span>)
      <span class="ruby-identifier">object</span> = <span class="ruby-keyword">super</span>
    <span class="ruby-keyword">ensure</span>
      <span class="ruby-identifier">has_final_field</span> = <span class="ruby-identifier">object</span>.<span class="ruby-identifier">instance_variables</span>.<span class="ruby-identifier">any?</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^@[A-Z]/</span> }
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">has_final_field</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">safe_initialization?</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;there was an instance of #{object.class} with final field but not marked with safe_initialization!&quot;</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- ensure_safe_initialization_when_final_fields_are_present-source -->
          
        </div>

        

        
      </div><!-- ensure_safe_initialization_when_final_fields_are_present-method -->

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Has to be called by children.</p>
          
          
            <div class="method-calls-super">
              Calls superclass method
              
            </div>
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/concurrent/synchronization/object.rb, line 34</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>
  <span class="ruby-keyword">super</span>
  <span class="ruby-identifier">initialize_volatile_with_cas</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- new-source -->
          
        </div>

        

        
      </div><!-- new-method -->

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(*args, &block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          
            <div class="method-calls-super">
              Calls superclass method
              
            </div>
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/concurrent/synchronization/object.rb, line 54</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">new</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">object</span> = <span class="ruby-keyword">super</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">ensure</span>
  <span class="ruby-identifier">object</span>.<span class="ruby-identifier">full_memory_barrier</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">object</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- new-source -->
          
        </div>

        

        
      </div><!-- new-method -->

    
      <div id="method-c-safe_initialization-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">safe_initialization!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>By calling this method on a class, it and all its children are marked to be
constructed safely. Meaning that all writes (ivar initializations) are made
visible to all readers of newly constructed object. It ensures same
behaviour as Java&#39;s final fields. @example</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">AClass</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Concurrent</span><span class="ruby-operator">::</span><span class="ruby-constant">Synchronization</span><span class="ruby-operator">::</span><span class="ruby-constant">Object</span>
  <span class="ruby-identifier">safe_initialization!</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>
    <span class="ruby-ivar">@AFinalValue</span> = <span class="ruby-string">&#39;value&#39;</span> <span class="ruby-comment"># published safely, does not have to be synchronized</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>
          
          

          
          <div class="method-source-code" id="safe_initialization-21-source">
            <pre><span class="ruby-comment"># File lib/concurrent/synchronization/object.rb, line 50</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">safe_initialization!</span>
  <span class="ruby-comment"># define only once, and not again in children</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">safe_initialization?</span>

  <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">new</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
    <span class="ruby-identifier">object</span> = <span class="ruby-keyword">super</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">ensure</span>
    <span class="ruby-identifier">object</span>.<span class="ruby-identifier">full_memory_barrier</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">object</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@safe_initialization</span> = <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- safe_initialization-21-source -->
          
        </div>

        

        
      </div><!-- safe_initialization-21-method -->

    
      <div id="method-c-safe_initialization-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">safe_initialization?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@return [true, false] if this class is safely initialized.</p>
          
          

          
          <div class="method-source-code" id="safe_initialization-3F-source">
            <pre><span class="ruby-comment"># File lib/concurrent/synchronization/object.rb, line 64</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">safe_initialization?</span>
  <span class="ruby-ivar">@safe_initialization</span> = <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-keyword">defined?</span> <span class="ruby-ivar">@safe_initialization</span>
  <span class="ruby-ivar">@safe_initialization</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:safe_initialization?</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">safe_initialization?</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- safe_initialization-3F-source -->
          
        </div>

        

        
      </div><!-- safe_initialization-3F-method -->

    
      <div id="method-c-volatile_cas_fields" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">volatile_cas_fields</span><span
            class="method-args">(inherited = true)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@param [true,false] inherited should inherited volatile with CAS fields be
returned? @return [Array&lt;Symbol&gt;] Returns defined volatile with CAS
fields on this class.</p>
          
          

          
          <div class="method-source-code" id="volatile_cas_fields-source">
            <pre><span class="ruby-comment"># File lib/concurrent/synchronization/object.rb, line 127</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">volatile_cas_fields</span>(<span class="ruby-identifier">inherited</span> = <span class="ruby-keyword">true</span>)
  <span class="ruby-ivar">@volatile_cas_fields</span> <span class="ruby-operator">||=</span> []
  ((<span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">volatile_cas_fields</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:volatile_cas_fields</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">inherited</span>) <span class="ruby-operator">||</span> []) <span class="ruby-operator">+</span>
      <span class="ruby-ivar">@volatile_cas_fields</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- volatile_cas_fields-source -->
          
        </div>

        

        
      </div><!-- volatile_cas_fields-method -->

    
    </section><!-- public-class-method-details -->
  
     <section id="private-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Private Class Methods</h3>

    
      <div id="method-c-define_initialize_volatile_with_cas" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">define_initialize_volatile_with_cas</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="define_initialize_volatile_with_cas-source">
            <pre><span class="ruby-comment"># File lib/concurrent/synchronization/object.rb, line 135</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">define_initialize_volatile_with_cas</span>
  <span class="ruby-identifier">assignments</span> = <span class="ruby-ivar">@volatile_cas_fields</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;@Atomic#{name.to_s.gsub(/(?:^|_)(.)/) { $1.upcase }} = AtomicReference.new(nil)&quot;</span> }.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;\n&quot;</span>)
  <span class="ruby-identifier">class_eval</span> <span class="ruby-value">&lt;&lt;-RUBY
    def initialize_volatile_with_cas
      super
      #{assignments}
    end
  RUBY</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- define_initialize_volatile_with_cas-source -->
          
        </div>

        

        
      </div><!-- define_initialize_volatile_with_cas-method -->

    
    </section><!-- private-class-method-details -->
  
     <section id="private-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Private Instance Methods</h3>

    
      <div id="method-i-initialize_volatile_with_cas" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">initialize_volatile_with_cas</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="initialize_volatile_with_cas-source">
            <pre><span class="ruby-comment"># File lib/concurrent/synchronization/object.rb, line 147</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize_volatile_with_cas</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- initialize_volatile_with_cas-source -->
          
        </div>

        

        
      </div><!-- initialize_volatile_with_cas-method -->

    
    </section><!-- private-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 4.0.0.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

